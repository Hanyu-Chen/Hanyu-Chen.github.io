---
layout:     post
title:      实习周记
subtitle:   记录前端开发时遇到的问题和解决方案
date:       2021-03-10
author:     Hanyu Chen
header-img: img/post-bg-miui6.jpg
catalog: true
tags:
    - Internship
---

## 前言

最近入职鹅厂做实习生，本来应该早些开始更新开发记录的，奈何每次临到动笔时因为各种原因而延后了（没错就是游戏！）

今天开始更新内容，主要总结一周以来碰到的麻烦，提高今后开发的效率。

### 2021-03-10

裂开，说好的10号写的今天都12号晚上了。又加班到九点多，心累......

不过今天的话多晚都要整理完，正好两个星期合一起吧。

> 1. 跨域问题

在开发过程中，跨域问题一直是经常碰到的。因为浏览器安全限制，我们的的请求必须在同域名同接口的条件下进行，否则会触发CORS检查。这一问题简称跨域。

解决方法有很多，下面列出较简单的两种：

(1). 后端跨域

一般来说，跨域问题都会放在后端解决，是较为简单通用的解决方式。

CORS在检查的时候会check发回来报文的头部，因此只需要后端服务器在发给前端客户端的请求header中添加 `Access-Control-Request-Headers: *` 即可。

**注意，这一设置可能引发安全问题，建议将这一头部指定域名发回。**

(2). 前端跨域

前端同样可以解决。如果使用Vue cli工具，可以直接在vue.config.js里面添加代理，代码如下:

```javascript
module.exports = {
  publicPath: './',
  devServer: {
    // 这个代理会首先检测原地址，如果碰到/api则将其替换为空，然后将主域名替换为target里的值。
    proxy: {
      '/api': {
        target: `目标域名，如www.baidu.com`,
        changeOrigin: true,
        pathRewrite: {
          '^/api' : ''
        }
      },
    },
  },
  assetsDir: "static" // 打包后静态资源的路径名
}
```

这一方法问题在于当后端有登陆跳转的时候，代理会失效，因为跳转后的域名有了变化，不是很灵活。



> 2. nginx配置问题

一直以来nginx配置一直是网页开发较难解决的问题。因为每个人配置都不尽相同，很难在网上找到通用的解决方案，需要

nginx的工作原理在此不多做赘述，CSDN上有很多相关博客。这里主要记录遇到的问题以及解决方案。

(1). 无法访问静态资源

很离谱，真的很离谱。。。在conf中明明设置了静态资源root路径，但是网页却访问404。检查半天也没发现路径有问题。最后发现是额外多出了对/static路径的配置。这一点导致默认的static文件路径被修改了，因此找不到静态资源。

(2). 访问根目录静态资源的时候被直接代理到后端

具体来讲是在根目录下的配置里面写了代理地址，导致请求发到nginx之后被直接代理到后端而非从static文件夹下找静态资源。这是由于在根目录location下面写了proxy字段，导致请求发到nginx之后跳过静态资源的获取直接访问后端端口。

> 3. 使用flex注意点

在css中我们常常使用flex来对元素进行排版。但是在某一次使用中，发现flex失效了，无论怎么设置元素都会重合在一起。最后debug找到问题在于元素的position参数设置。由于之前使用absolute绝对位置，导致任何浮动效果都失去作用。如果有碰到类似问题的小伙伴可以检查一下flex内部子元素的配置。

> 4. Vue父组件对子组件传值的异步操作

很多时候，我们需要使用传值来构建父子组件的通信。如果开发中碰到这样一个问题: 我们需要在子组件中渲染数据，并且这个数据是通过父组件从后端get获得的，那么就会有可能造成异步问题，即子组件在获得数据之前就已经渲染(因为从后端get数据需要时间)，并且无法在数据获取完成后做相应的动态更新。

这时候我们需要使用watch侦听器来监控props，如此当父组件完成数据获取之后，子组件的props能够侦听到变化并且改变子组件的data，最后将这一变量v-bind到我们想要渲染的地方即可。







